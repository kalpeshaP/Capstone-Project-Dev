2025-05-18 10:37:11,755-INFO-file getting extracted ...
2025-05-18 10:37:11,755-INFO-Extraction of linux file started ...
2025-05-18 10:37:11,772-INFO-Connected (version 2.0, client OpenSSH_8.7)
2025-05-18 10:37:11,847-INFO-Authentication (password) successful!
2025-05-18 10:37:12,084-INFO-[chan 0] Opened sftp connection (server version 3)
2025-05-18 10:37:12,092-INFO-[chan 0] sftp session closed.
2025-05-18 10:37:12,093-INFO-Extraction of linux file completed ...
2025-05-18 10:37:12,093-INFO-file getting completed ...
2025-05-18 10:37:12,094-INFO-Sales data extraction started...
2025-05-18 10:37:12,380-INFO-Sales data extraction completed
2025-05-18 10:37:12,380-INFO-Product data Extraction Started..
2025-05-18 10:37:12,526-INFO-Product data extraction Completed..
2025-05-18 10:37:12,526-INFO-Supplier data Extraction Started..
2025-05-18 10:37:12,677-INFO-Supplier data extraction Completed..
2025-05-18 10:37:12,677-INFO-Inventory data Extraction Started..
2025-05-18 10:37:12,926-INFO-Inventory data extraction Completed..
2025-05-18 10:37:12,927-INFO-Stores data Extraction Started..
2025-05-18 10:37:13,283-INFO-Stores data extraction Completed..
2025-05-18 10:37:17,823-INFO-Loading for fact_sales started...
2025-05-18 10:37:17,832-INFO-Fact_sales table loading started...
2025-05-18 10:37:17,832-INFO-insert into fact_sales(sales_id,product_id,store_id,quantity,total_sales,sale_date)
                           select sales_id,product_id,store_id,quantity,sales_amount,sale_date from sales_with_details
2025-05-18 10:37:17,939-INFO-Fact_sales table loading completed...
2025-05-18 11:05:18,374-INFO-Loading for monthly_sales_summary started...
2025-05-18 11:05:18,420-INFO-monthly_sales_summary table loading started...
2025-05-18 11:05:18,420-INFO-
            INSERT INTO monthly_sales_summary(product_id, month, year, total_sales)
            SELECT product_id, month, year, total_sales
            FROM monthly_sales_summary_source
        
2025-05-18 11:05:18,444-INFO-monthly_sales_summary table loading completed...
2025-05-18 11:10:20,434-INFO-Loading for fact_inventory started...
2025-05-18 11:10:20,447-INFO-fact_inventory table loading started...
2025-05-18 11:10:20,447-INFO-
            INSERT INTO fact_inventory(product_id, store_id, quantity_on_hand, last_updated)
            SELECT product_id, store_id, quantity_on_hand, last_updated
            FROM staging_inventory
        
2025-05-18 11:10:20,465-INFO-fact_inventory table loading completed...
2025-05-18 11:20:07,483-INFO-Loading for inventory_level_by_store started...
2025-05-18 11:20:07,498-INFO-inventory_level_by_store table loading started...
2025-05-18 11:22:25,927-INFO-Loading for inventory_level_by_store started...
2025-05-18 11:22:26,000-INFO-inventory_level_by_store table loading started...
2025-05-18 11:22:26,000-INFO-
            INSERT INTO inventory_level_by_store(store_id, total_inventory)
            SELECT store_id, total_inventory
            FROM aggregated_inventory_level
        
2025-05-18 11:22:26,010-ERROR-Error while loading inventory_level_by_store table (pymysql.err.ProgrammingError) (1146, "Table 'retaildwh.inventory_level_by_store' doesn't exist")
[SQL: 
            INSERT INTO inventory_level_by_store(store_id, total_inventory)
            SELECT store_id, total_inventory
            FROM aggregated_inventory_level
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "C:\Users\pinga\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\pinga\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pinga\AppData\Roaming\Python\Python313\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\pinga\AppData\Roaming\Python\Python313\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
    ~~~~~~~~~~^^^
  File "C:\Users\pinga\AppData\Roaming\Python\Python313\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pinga\AppData\Roaming\Python\Python313\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
    ~~~~~~~~~~~^^
  File "C:\Users\pinga\AppData\Roaming\Python\Python313\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\pinga\AppData\Roaming\Python\Python313\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\pinga\AppData\Roaming\Python\Python313\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\pinga\AppData\Roaming\Python\Python313\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1146, "Table 'retaildwh.inventory_level_by_store' doesn't exist")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\ETL CLASSES\Capstone_Project\pythonProject1\CodeBase\load.py", line 84, in load_inventory_level_by_store_table
    conn.execute(query)
    ~~~~~~~~~~~~^^^^^^^
  File "C:\Users\pinga\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\pinga\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\pinga\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\pinga\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\pinga\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\pinga\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\pinga\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\pinga\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pinga\AppData\Roaming\Python\Python313\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
  File "C:\Users\pinga\AppData\Roaming\Python\Python313\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
    ~~~~~~~~~~^^^
  File "C:\Users\pinga\AppData\Roaming\Python\Python313\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pinga\AppData\Roaming\Python\Python313\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
    ~~~~~~~~~~~^^
  File "C:\Users\pinga\AppData\Roaming\Python\Python313\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
  File "C:\Users\pinga\AppData\Roaming\Python\Python313\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\pinga\AppData\Roaming\Python\Python313\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\pinga\AppData\Roaming\Python\Python313\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1146, "Table 'retaildwh.inventory_level_by_store' doesn't exist")
[SQL: 
            INSERT INTO inventory_level_by_store(store_id, total_inventory)
            SELECT store_id, total_inventory
            FROM aggregated_inventory_level
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-18 11:25:06,388-INFO-Loading for inventory_levels_by_store started...
2025-05-18 11:25:06,399-INFO-inventory_levels_by_store table loading started...
2025-05-18 11:25:06,399-INFO-
            INSERT INTO inventory_levels_by_store(store_id, total_inventory)
            SELECT store_id, total_inventory
            FROM aggregated_inventory_level
        
2025-05-18 11:25:06,419-INFO-inventory_levels_by_store table loading completed...
